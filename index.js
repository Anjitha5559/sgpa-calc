var data = {
    branches: [
        {
            name: "CSE",
            semesters: [
                {
                    name: "Semester 1",
                    subjects: [
                        {
                            name: "Maths",
                            credits: 4
                        },
                        {
                            name: "Physics/Chemistry",
                            credits: 4
                        },
                        {
                            name: "Graphics/Mechanics",
                            credits: 3
                        },
                        {
                            name: "BCME/BEEE",
                            credits: 4
                        },
                        {
                            name: "Phy/Che Lab",
                            credits: 1
                        },
                        {
                            name: "C&M Workshop/ E&E Workshop",
                            credits: 1
                        }

                    ]
                },
                {
                    name: "Semester 2",
                    subjects: [
                        {
                            name: "Maths",
                            credits: 4
                        },
                        {
                            name: "Physics/Chemistry",
                            credits: 4
                        },
                        {
                            name: "Graphics/Mechanics",
                            credits: 3
                        },
                        {
                            name: "BCME/BEEE",
                            credits: 4
                        },
                        {
                            name: "Programming in C",
                            credits: 3
                        },
                        {
                            name: "Phy/Che Lab",
                            credits: 1
                        },
                        {
                            name: "C&M Workshop/ E&E Workshop",
                            credits: 1
                        }

                    ]
                },
                {
                    name: "Semester 3",
                    subjects: [
                        {
                            name: "DISCRETE MATHEMATICAL STRUCTURES",
                            credits: 4
                        },
                        {
                            name: "DATA STRUCTURES",
                            credits: 4
                        },
                        {
                            name: "OBJECT ORIENTED PROGRAMMING USING JAVA",
                            credits: 4
                        },
                        {
                            name: "LOGIC SYSTEMS DESIGN",
                            credits: 4
                        },
                        {
                            name: "DESIGN AND ENGINEERING",
                            credits: 2
                        },
                        {
                            name: "DATA STRUCTURES LAB",
                            credits: 2
                        },
                        {
                            name: "OBJECT ORIENTED PROGRAMMING USING JAVA LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 4",
                    subjects: [
                        {
                            name: "GRAPH THEORY",
                            credits: 4
                        },
                        {
                            name: "Computer Organization and Architecture",
                            credits: 4
                        },
                        {
                            name: "Database Management Systems",
                            credits: 4
                        },
                        {
                            name: "OPERATING SYSTEMS",
                            credits: 4
                        },
                        {
                            name: "PROFESSIONAL ETHICS",
                            credits: 2
                        },
                        {
                            name: "DIGITAL LAB",
                            credits: 2
                        },
                        {
                            name: "OPERATING SYSTEMS LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 5",
                    subjects: [
                        {
                            name: "FORMAL LANGUAGES AND AUTOMATA THEORY",
                            credits: 4
                        },
                        {
                            name: "COMPUTER NETWORKS",
                            credits: 4
                        },
                        {
                            name: "SYSTEM SOFTWARE",
                            credits: 4
                        },
                        {
                            name: "MICROPROCESSORS AND MICROCONTROLLERS",
                            credits: 4
                        },
                        {
                            name: "MANAGEMEENT OF SOFTWARE SYSTEMS",
                            credits: 3
                        },
                        {
                            name: "SYSTEM SOFTWARE AND MICROPROCESSORS LAB",
                            credits: 2
                        },
                        {
                            name: "DATABASE MANAGEMENT SYSTEMS LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 6",
                    subjects: [
                        {
                            name: "COMPILER DESIGN",
                            credits: 4
                        },
                        {
                            name: "COMPUTER GRAPHICS AND IMAGE PROCESSING",
                            credits: 4
                        },
                        {
                            name: "ALGORITHM ANALYSIS AND DESIGN",
                            credits: 4
                        },
                        {
                            name: "ELECTIVE 1",
                            credits: 3
                        },
                        {
                            name: "INDUSTRIAL ECONOMICS AND FOREIGN TRADE",
                            credits: 3
                        },
                        {
                            name: "COMPREHENSIVE COURSE WORK",
                            credits: 1
                        },
                        {
                            name: "NETWORKING LAB",
                            credits: 2
                        },
                        {
                            name: "MINI PROJECT",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 7",
                    subjects: [
                        {
                            name: "ARTIFICIAL INTELLIGENCE",
                            credits: 4
                        },
                        {
                            name: "ELECTIVE II",
                            credits: 3
                        },
                        {
                            name: "OPEN ELECTIVE",
                            credits: 3
                        },
                        {
                            name: "INDUSTRY SAFETY ENGINEERING",
                            credits: 2
                        },
                        {
                            name: "COMPLILER LAB",
                            credits: 2
                        },
                        {
                            name: "SEMINAR",
                            credits: 2
                        },
                        {
                            name: "PROJECT PHASE 1",
                            credits: 2
                        }
                    ]


                },
                {
                    name: "Semester 8",
                    subjects: [
                        {
                            name: "DISTRIBUTED COMPUTING",
                            credits: 4
                        },
                        {
                            name: "ELECTIVE III",
                            credits: 3
                        },
                        {
                            name: "ELECTIVE IV",
                            credits: 3
                        },
                        {
                            name: "ELECTIVE V",
                            credits: 3
                        },
                        {
                            name: "COMPREHENSIVE COURSE VIVA",
                            credits: 1
                        },
                        {
                            name: "PROJECT PHASE 2",
                            credits: 2
                        }
                    ]


                }




            ]
        },
        {
            name: "ECE",
            semesters: [
                {
                    name: "Semester 1",
                    subjects: [
                        {
                            name: "Maths",
                            credits: 4
                        },
                        {
                            name: "Physics/Chemistry",
                            credits: 4
                        },
                        {
                            name: "Graphics/Mechanics",
                            credits: 3
                        },
                        {
                            name: "BCME/BEEE",
                            credits: 4
                        },
                        {
                            name: "Phy/Che Lab",
                            credits: 1
                        },
                        {
                            name: "C&M Workshop/ E&E Workshop",
                            credits: 1
                        }

                    ]
                },
                {
                    name: "Semester 2",
                    subjects: [
                        {
                            name: "Maths",
                            credits: 4
                        },
                        {
                            name: "Physics/Chemistry",
                            credits: 4
                        },
                        {
                            name: "Graphics/Mechanics",
                            credits: 3
                        },
                        {
                            name: "BCME/BEEE",
                            credits: 4
                        },
                        {
                            name: "Programming in C",
                            credits: 3
                        },
                        {
                            name: "Phy/Che Lab",
                            credits: 1
                        },
                        {
                            name: "C&M Workshop/ E&E Workshop",
                            credits: 1
                        }

                    ]
                },
                {
                    name: "Semester 3",
                    subjects: [
                        {
                            name: "DISCRETE MATHEMATICAL STRUCTURES",
                            credits: 4
                        },
                        {
                            name: "DATA STRUCTURES",
                            credits: 4
                        },
                        {
                            name: "OBJECT ORIENTED PROGRAMMING USING JAVA",
                            credits: 4
                        },
                        {
                            name: "LOGIC SYSTEMS DESIGN",
                            credits: 4
                        },
                        {
                            name: "DESIGN AND ENGINEERING",
                            credits: 2
                        },
                        {
                            name: "DATA STRUCTURES LAB",
                            credits: 2
                        },
                        {
                            name: "OBJECT ORIENTED PROGRAMMING USING JAVA LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 4",
                    subjects: [
                        {
                            name: "GRAPH THEORY",
                            credits: 4
                        },
                        {
                            name: "Computer Organization and Architecture",
                            credits: 4
                        },
                        {
                            name: "Database Management Systems",
                            credits: 4
                        },
                        {
                            name: "OPERATING SYSTEMS",
                            credits: 4
                        },
                        {
                            name: "PROFESSIONAL ETHICS",
                            credits: 2
                        },
                        {
                            name: "DIGITAL LAB",
                            credits: 2
                        },
                        {
                            name: "OPERATING SYSTEMS LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 5",
                    subjects: [
                        {
                            name: "FORMAL LANGUAGES AND AUTOMATA THEORY",
                            credits: 4
                        },
                        {
                            name: "COMPUTER NETWORKS",
                            credits: 4
                        },
                        {
                            name: "SYSTEM SOFTWARE",
                            credits: 4
                        },
                        {
                            name: "E MICROPROCESSORS AND MICROCONTROLLERS",
                            credits: 4
                        },
                        {
                            name: "MANAGEMEENT OF SOFTWARE SYSTEMS",
                            credits: 3
                        },
                        {
                            name: "SYSTEM SOFTWARE AND MICROPROCESSORS LAB",
                            credits: 2
                        },
                        {
                            name: "DATABASE MANAGEMENT SYSTEMS LAB",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 6",
                    subjects: [
                        {
                            name: "E COMPILER DESIGN",
                            credits: 4
                        },
                        {
                            name: " E COMPUTER GRAPHICS AND IMAGE PROCESSING",
                            credits: 4
                        },
                        {
                            name: "E ALGORITHM ANALYSIS AND DESIGN",
                            credits: 4
                        },
                        {
                            name: "E ELECTIVE 1",
                            credits: 3
                        },
                        {
                            name: "INDUSTRIAL ECONOMICS AND FOREIGN TRADE",
                            credits: 3
                        },
                        {
                            name: "COMPREHENSIVE COURSE WORK",
                            credits: 1
                        },
                        {
                            name: "NETWORKING LAB",
                            credits: 2
                        },
                        {
                            name: "MINI PROJECT",
                            credits: 2
                        }
                    ]
                },
                {
                    name: "Semester 7",
                    subjects: [
                        {
                            name: "WIRELESS COMMUNICATION",
                            credits: 4
                        },
                        {
                            name: "ELECTIVE II",
                            credits: 3
                        },
                        {
                            name: "OPEN ELECTIVE",
                            credits: 3
                        },
                        {
                            name: "INDUSTRY SAFETY ENGINEERING",
                            credits: 2
                        },
                        {
                            name: "ELECTROMAGNETICS LAB",
                            credits: 2
                        },
                        {
                            name: "SEMINAR",
                            credits: 2
                        },
                        {
                            name: "PROJECT PHASE 1",
                            credits: 2
                        }
                    ]


                },
                {
                    name: "Semester 8",
                    subjects: [
                        {
                            name: "INSTRUMENTATION",
                            credits: 4
                        },
                        {
                            name: "ELECTIVE III",
                            credits: 3
                        },
                        {
                            name: "ELECTIVE IV",
                            credits: 3
                        },
                        {
                            name: "ELECTIVE V",
                            credits: 3
                        },
                        {
                            name: "COMPREHENSIVE VIVA VOICE",
                            credits: 1
                        },
                        {
                            name: "PROJECT PHASE 2",
                            credits: 2
                        }
                    ]


                }



            ]
}]}
var branches = JSON.parse(JSON.stringify(data)).branches;
var gradeSelect = document.getElementById("gradeSelector");
var branchSelect = document.getElementById("branchSelector");
var GPA = document.getElementById("GPA");
var semesterSelect = document.getElementById("semesterSelector");
const result = document.getElementById("result");
const mainBody = document.getElementById("mainBody");
const CGPA = document.getElementById("CGPA");
const noOfSem = document.getElementById("noOfSem");

chooseGPA();

function chooseGPA() {

    GPA.addEventListener("change", function () {
        console.log("GPA CHanger called");
        if (GPA.value == "SGPA") {
            branchSelect.innerHTML='';
            semesterSelect.innerHTML='';
            gradeSelect.innerHTML='';
            noOfSem.innerHTML='';
            

            chooseBranch();
        }
        else if (GPA.value == "CGPA") {
            branchSelect.innerHTML='';
            semesterSelect.innerHTML='';
            gradeSelect.innerHTML='';
            chooseCGPA();
        }
        else {
            alert("PLEASE SELECT EITHER SGPA OR CGPA");
        }
    });
}

function chooseBranch() {
    var options = '<option id="options">Branch</option>';
    for (var i = 0; i < branches.length; i++) {
        options += "<option value=" + branches[i].name + ">" + branches[i].name + "</option>";
    }
    branchSelect.innerHTML = '<select id="BRANCH" class="dropDown">' + options + '</select>';
    var BRANCH = document.getElementById("BRANCH");
    BRANCH.addEventListener("change", function () {
        console.log("branch chooser changed");
        var branch = BRANCH.value;
        var semesters =  getSemester(branch);
        chooseSemester(branch,semesters);

    });
}

function chooseSemester(branch,semesters) {
    var options = '<option id="options">Semester</option>';
    for (var i = 0; i < semesters.length; i++) {
        var newName = semesters[i].name.replace("Semester", "");
        options += "<option value=" + newName + ">" + semesters[i].name + "</option>";
    }
    semesterSelect.innerHTML = '<select id="SEMESTER" class="dropDown">' + options + '</select>';
    var SEMESTER = document.getElementById("SEMESTER");
    SEMESTER.addEventListener("change", function () {
        console.log("semester chooser changed");
        var semester = SEMESTER.value;
        var subjects = getSubjects(branch,semester);
        chooseSubject(subjects);
    });
}

function chooseSubject(subjects) {
    var subData = "";

    for (var i = 0; i < subjects.length; i++) {
        subData += 
        `<div class="subdata row">
        <div class="subjects" credit=`+subjects[i].credits+`>
        `+subjects[i].name+`
        </div>

            <select name="grade" class="dropDown">
                <option id="opt1" value="10">S</option>
                <option id="opt1" value="9">A+</option>
                <option id="opt1" value="8.5">A</option>
                <option id="opt1" value="8">B+</option>
                <option id="opt1" value="7.5">B</option>
                <option id="opt1" value="7">C+</option>
                <option id="opt1" value="6.5">C</option>
                <option id="opt1" value="6">D</option>
                <option id="opt1" value="5">P</option>
                <option id="opt1" value="0">F</option>
            </select>
    </div>`;
}
gradeSelect.innerHTML = subData;
gradeSelect.innerHTML+='<div id="btn">Calculate</div>'
const btn = document.getElementById("btn");
btn.addEventListener('click',function(){
    calculateSGPA(subjects);
})

}
function calculateSGPA(subjects){
    var subjects = document.getElementsByClassName("subdata");
    var total = 0;
    var max=0;
    for(var i=0;i<subjects.length;i++){
    var credit = subjects[i].children[0].getAttribute("credit");
    var grade = subjects[i].children[1].value;
    total += credit*grade;
    max+=credit*10;
    }
 
   result.innerHTML = "your SGPA is : " + Math.floor((total/max)*1000)/100;


}
function chooseCGPA(){
    var options = '<option id="options">No. of Semesters </option>';
    for(var i=1;i<=8;i++){
        options += "<option value=" + i + ">" + i + "</option>";
    }
    noOfSem.innerHTML += '<select id="SEMESTER" class="dropDown">' + options + '</select>';
    var SEMESTER = document.getElementById("SEMESTER");
    SEMESTER.addEventListener("change", function () {
        console.log("CGPASelector changed");
        var currentSemester = SEMESTER.value;
        for(j=1;j<=currentSemester;j++){
            gradeSelect.innerHTML +=`            
            <form id="CGPAForm"class="row">
            <label for="CGPA">${j}</label>
            <input type="number" name="CGPA" id="CGPA${j}"class="formInput" placeholder="Enter SGPA" required>`

            
        }
        gradeSelect.innerHTML +=`<div id="btn">Calculate</div>`;
        const btn = document.getElementById("btn");
        btn.addEventListener('click',function(){
            var totalCGPA = 0;
            for(var k=1;k<=currentSemester;k++){
                var CGPA = document.getElementById("CGPA"+k);
                if(CGPA.value>10 || CGPA.value<0){
                    alert("PLEASE ENTER VALID SGPA");
                    return;
                }
                if(CGPA.value==""){
                    alert("PLEASE ENTER ALL THE SGPA");
                    return;
                }
                totalCGPA += parseFloat(CGPA.value);
            }
            var CGPA = totalCGPA/currentSemester;
            const result = document.getElementById("result");
            result.innerHTML =  "your CGPA is : " + Math.floor((CGPA)*100)/100;
            
        });
    });

}
function getSemester(branch){
    for(var i=0;i<branches.length;i++){
        if(branches[i].name==branch){
            var semesters = branches[i].semesters;
            break;
        }
    }
      return semesters;   
}
function getSubjects(branch,semester){
    var semesters = getSemester(branch);
    var subjects = semesters[semester-1].subjects;
  
    return subjects;
}